name: "Git Commit & Push"
description: "Commit and push changes with github-actions[bot]"

inputs:
  scope:
    required: true
    description: "Scope in Commit message"

runs:
  using: "composite"
  steps:
    - name: setup
      uses: actions/setup-java@v4
      with:
        persist-credentials: true
        distribution: 'temurin'
        java-version: '25'

    - name: ${inputs.scope}
      env:
        PPS_INTEGRATION_NOTION: ${{ secrets.PPS_INTEGRATION_NOTION }}
      run: ./gradlew :${inputs.scope}:bootRun
      shell: bash

    - run: |
        git config user.name "github-actions[bot]"
        git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
        git add storage/
        git commit \
            -m "chore(${{ inputs.scope }}): ${{ inputs.scope }} Notion JSONs at $(date -u +'%Y-%m-%d %H:%M:%S')" \
            -m "$(git diff --cached --name-status)" \
            || echo "âœ… No changes to commit"
        git push
      shell: bash